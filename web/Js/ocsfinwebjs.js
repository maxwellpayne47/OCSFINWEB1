function commaSeparateNumber(a){for(;/(\d+)(\d{3})/.test(a.toString());)a=a.toString().replace(/(\d+)(\d{3})/,"$1,$2");return a}function format_number(a){$(a).find(".format_number").each(function(){var a=parseFloat($(this).text()).toFixed(2);0>a&&$(this).css({color:"red"})})}function mydetails(){$.post("/OCSFINWEB/MyStaffStatement.do",{param:"mydetails"},function(a){var b,c;if($.isEmptyObject(a))alert("no data");else{for(var d=a.length,e=0;d>e;e++)b=[a[e].xmlData];var f=b.toString();c=$.parseXML(f),$xml=$(c);var g=$xml.find("AgressoQE");$(g).each(function(){var a=$(this).find("dim_value").text(),b=$(g).find("description").text();$("#staffname_span").text(b),$("#staffaccount_span").text(a)})}},"json")}function loadmystatement(){$("#staffstatement_htmltbl tr:not(:first)").remove(),html='<tr id="loaderrow"><td colspan="8" align="center">'+img+"</td</tr>",$("#loadingmsg_span").text("Please wait while your details are loading..."),$("#staffstatement_htmltbl").append(html).show(),$.post("/OCSFINWEB/MyStaffStatement.do",{param:"mystatement"},function(a){var b,c;if($.isEmptyObject(a))alert("empty");else{for(var d=a.length,e=0;d>e;e++)b=[a[e].xmlData];var f=b.toString();c=$.parseXML(f),$xml=$(c);var g=$xml.find("AgressoQE"),h="";$("#staffstatement_htmltbl tr:not(:first)").remove(),$(g).each(function(){var a=$(this).find("voucher_no").text(),b=$(this).find("ext_inv_ref").text(),c=$.format.date($(this).find("due_date").text(),"dd-MMM-yyyy"),d=$(this).find("xdim_6").text(),e=$(this).find("pay_currency").text(),f=commaSeparateNumber(parseFloat($(this).find("f0_currency_amo").text()).toFixed(2)),g=commaSeparateNumber(parseFloat($(this).find("amount").text()).toFixed(2)),i=$(this).find("description").text();h+="<tr><td>"+a+"</td><td>"+b+"</td><td>"+c+"</td><td>"+d+"</td><td>"+e+'</td><td><span class="curamount_span format_number">'+f+'</span></td><td><span class="usdamt_span format_number">'+g+"</span></td><td>"+i+"</td></tr>"}),$("#loaderrow").remove(),$("#staffstatement_htmltbl tbody").append(h).show();var i=parseFloat($("#staffstatement_htmltbl tbody tr:last").find(".usdamt_span").text());0>i?($("#iou_msg_span").text("ICRAF owes you USD$:").css({color:"green","font-size":"24px"}).end(),$("#iou_amt_span").text(-1*i).css({"font-size":"24px","text-decoration":"underline"})):($("#iou_msg_span").text("You owe ICRAF USD$:").css({color:"red","font-size":"24px"}),$("#iou_amt_span").text(i).css({"font-size":"24px","text-decoration":"underline"})),$("#staffstatement_htmltbl tbody tr:last").clone().appendTo("#staffstatement_htmltbl tfoot"),$("#staffstatement_htmltbl tbody tr:last").remove(),$("#staffstatement_htmltbl tfoot").find(".curamount_span").text("")}format_number("#staffstatement_htmltbl")},"json")}function loadmainprojects(a,b){$("#finweb_htmltbl tbody tr").remove(),html='<tr id="loaderrow"><td colspan="7" align="center">'+img+"</td</tr>",$("#finweb_htmltbl").append(html).show(),$.post("/OCSFINWEB/FinanceWeb.do",{cc:a,en:b,mode:"bh"},function(c){var d,e;if($.isEmptyObject(c))alert("We got nothing");else{for(var f=c.length,g=0;f>g;g++)d=[c[g].xmlData];var h=d.toString();e=$.parseXML(h),$xml=$(e);var i=$xml.find("AgressoQE"),j="";$("#finweb_htmltbl tbody tr").remove(),$(i).each(function(){var i,c=$(this).find("r0dim3").text(),d=parseFloat($(this).find("pld_amount").text()).toFixed(0),e=parseFloat($(this).find("amount").text()).toFixed(0),f=parseFloat($(this).find("co_rest_amount").text()).toFixed(0),g=parseFloat(e)+parseFloat(f),h=parseFloat(d)-parseFloat(g);i=isFinite(parseFloat(100*(g/d)).toFixed(0))===!0?parseFloat(100*(g/d)).toFixed(0):100,j+='<tr><td><a class="drilldown_link" href="/OCSFINWEB/Pages/CostCentre.jsp?cc='+a+"&mj="+c+"&en="+b+'">'+c+'<a/></td><td><span class="format_number">'+commaSeparateNumber(d)+'</span></td><td><span class="format_number">'+commaSeparateNumber(e)+'</span></td><td><span class="format_number">'+commaSeparateNumber(f)+'</span></td><td><span class="format_number">'+commaSeparateNumber(g)+'</span></td><td><span class="format_number">'+commaSeparateNumber(h)+"</span></td><td>"+i+"</td></tr>"}),$("#loaderrow").remove(),$("#finweb_htmltbl").append(j).show(),$("#finweb_htmltbl tfoot tr").remove(),$("#finweb_htmltbl tbody tr:last").clone().appendTo("#finweb_htmltbl tfoot"),$("#finweb_htmltbl tbody tr:last").remove()}format_number("#finweb_htmltbl")},"json")}function loadchargecodes(a,b,c){$("#finweb_htmltbl tbody tr").remove(),html='<tr id="loaderrow"><td colspan="7" align="center">'+img+"</td</tr>",$("#finweb_htmltbl").append(html).show(),$.post("/OCSFINWEB/FinanceWeb.do",{costc:a,mainproj:b,entity:c,mode:"cc"},function(a){var b,c;if($.isEmptyObject(a))alert("We got nothing");else{for(var d=a.length,e=0;d>e;e++)b=[a[e].xmlData];var f=b.toString();c=$.parseXML(f),$xml=$(c);var g=$xml.find("AgressoQE"),h="";$("#finweb_htmltbl tbody tr").remove(),$(g).each(function(){var a,b=$(this).find("dim2").text(),c=$(this).find("dim3").text(),d=$(this).find("dim4").text(),e=$(this).find("dim5").text(),f=b.concat("-",c.concat("-",d.concat("-",e))),g=parseFloat($(this).find("pld_amount").text()).toFixed(0),i=parseFloat($(this).find("amount").text()).toFixed(0),j=parseFloat($(this).find("co_rest_amount").text()).toFixed(0),k=parseFloat(i)+parseFloat(j),l=g-k;a=isFinite(parseFloat(100*(k/g)).toFixed(0))===!0?parseFloat(100*(k/g)).toFixed(0):100,h+='<tr><td><a class="drilldown_link" href="/OCSFINWEB/Pages/NaturalClassification.jsp?wo='+d+"&et="+e+'">'+f+'<a/></td><td><span class="format_number">'+commaSeparateNumber(g)+'</span></td><td><span class="format_number">'+commaSeparateNumber(i)+'</span></td><td><span class="format_number">'+commaSeparateNumber(j)+'</span></td><td><span class="format_number">'+commaSeparateNumber(k)+'</span></td><td><span class="format_number">'+commaSeparateNumber(l)+"</span></td><td>"+a+"</td></tr>"}),$("#loaderrow").remove(),$("#finweb_htmltbl").append(h).show(),$("#finweb_htmltbl tfoot tr").remove(),$("#finweb_htmltbl tbody tr:last").clone().appendTo("#finweb_htmltbl tfoot"),$("#finweb_htmltbl tbody tr:last").remove()}format_number("#finweb_htmltbl")},"json")}function loadperaccountclass(a,b){$("#finweb_htmltbl tbody tr").remove(),html='<tr id="loaderrow"><td colspan="7" align="center">'+img+"</td</tr>",$("#finweb_htmltbl").append(html).show(),$.post("/OCSFINWEB/FinanceWeb.do",{workorder:a,entity:b,mode:"nc"},function(c){var d,e;if($.isEmptyObject(c))alert("We got nothing");else{for(var f=c.length,g=0;f>g;g++)d=[c[g].xmlData];var h=d.toString();e=$.parseXML(h),$xml=$(e);var i=$xml.find("AgressoQE"),j="";$("#finweb_htmltbl tbody tr").remove(),$(i).each(function(){var i,c=$(this).find("account_grp__1").text(),d=parseFloat($(this).find("pld_amount").text()).toFixed(0),e=parseFloat($(this).find("amount").text()).toFixed(0),f=parseFloat($(this).find("co_rest_amount").text()).toFixed(0),g=parseFloat(e)+parseFloat(f),h=d-g;i=isFinite(parseFloat(100*(g/d)).toFixed(0))===!0?parseFloat(100*(g/d)).toFixed(0):100,j+='<tr><td><a class="drilldown_link" href="/OCSFINWEB/Pages/AccountClass.jsp?ac='+c+"&wo="+a+"&et="+b+'">'+c+'<a/></td><td><span class="format_number">'+commaSeparateNumber(d)+'</span></td><td><span class="format_number">'+commaSeparateNumber(e)+'</span></td><td><span class="format_number">'+commaSeparateNumber(f)+'</span></td><td><span class="format_number">'+commaSeparateNumber(g)+'</span></td><td><span class="format_number">'+commaSeparateNumber(h)+"</span></td><td>"+i+"</td></tr>"}),$("#loaderrow").remove(),$("#finweb_htmltbl").append(j).show(),$("#finweb_htmltbl tfoot tr").remove(),$("#finweb_htmltbl tbody tr:last").clone().appendTo("#finweb_htmltbl tfoot"),$("#finweb_htmltbl tbody tr:last").remove()}format_number("#finweb_htmltbl")},"json")}function loadperaccount(a,b,c){$("#finweb_htmltbl tbody tr").remove(),html='<tr id="loaderrow"><td colspan="7" align="center">'+img+"</td</tr>",$("#finweb_htmltbl").append(html).show(),$.post("/OCSFINWEB/FinanceWeb.do",{accountclass:a,workorder:b,entity:c,mode:"ac"},function(a){var d,e;if($.isEmptyObject(a))alert("We got nothing");else{for(var f=a.length,g=0;f>g;g++)d=[a[g].xmlData];var h=d.toString();e=$.parseXML(h),$xml=$(e);var i=$xml.find("AgressoQE"),j="";$("#finweb_htmltbl tbody tr").remove(),$(i).each(function(){var i,a=$(this).find("dim1").text(),d=parseFloat($(this).find("pld_amount").text()).toFixed(0),e=parseFloat($(this).find("amount").text()).toFixed(0),f=parseFloat($(this).find("co_rest_amount").text()).toFixed(0).toLocaleString("en"),g=parseFloat(e)+parseFloat(f),h=d-g;i=isFinite(parseFloat(100*(g/d)).toFixed(0))===!0?parseFloat(100*(g/d)).toFixed(0):100,j+='<tr><td><a class="drilldown_link" href="/OCSFINWEB/Pages/ViewDetails.jsp?ac='+a+"&wo="+b+"&et="+c+'">'+a+'<a/></td><td><span class="format_number">'+commaSeparateNumber(d)+'</span></td><td><span class="format_number">'+commaSeparateNumber(e)+'</span></td><td><span class="format_number">'+commaSeparateNumber(f)+'</span></td><td><span class="format_number">'+commaSeparateNumber(g)+'</span></td><td><span class="format_number">'+commaSeparateNumber(h)+"</span></td><td>"+i+"</td></tr>"}),$("#loaderrow").remove(),$("#finweb_htmltbl").append(j).show(),$("#finweb_htmltbl tfoot tr").remove(),$("#finweb_htmltbl tbody tr:last").clone().appendTo("#finweb_htmltbl tfoot"),$("#finweb_htmltbl tbody tr:last").remove()}format_number("#finweb_htmltbl")},"json")}$(document).ready(function(){function a(){var a=1,b=$("#username_textfield").val(),c=$("#password_textfield").val();return""==$.trim(b)?($("#errmsg_username_span").html("Username required"),a=0):$("#errmsg_username_span").html(""),""==$.trim(c)?($("#errmsg_password_span").html("Password required"),a=0):$("#errmsg_password_span").html(""),1==a?!0:0==a?!1:void 0}$(".redirect_home").click(function(){window.location.href="/OCSFINWEB/Pages/Organogram.jsp"}),$("#loginsubmit_form").submit(function(b){0==a()&&b.preventDefault()})});var img='<img src="/OCSFINWEB/Images/sm_loader.gif" width="25" height="25">';